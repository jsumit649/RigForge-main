{% extends 'main.html' %}

{% block content %}

<div class="cart-container">
  <h1 class="cart-title">Your Cart</h1>
  <div class="cart-items">
    <!-- PC Builds Section -->
    {% if builds %}
        {% for build in builds %}
            <div class="cart-item cart-build">
                <h3 class="cart-build-title">{{ build.Name }}</h3>
                <p class="cart-build-price"><b>Build Price:</b> ₹{{ build.Total_Price }}</p>
                <form method="post" action="{% url 'remove-build' build.id %}" class="cart-build-remove-form">
                    {% csrf_token %}
                    <button type="submit" class="cart-build-remove-btn">Remove Build</button>
                </form>
                <ul class="cart-build-details">
                    <li><b>CPU:</b> {{ build.CPU.name }}</li>
                    <li><b>Motherboard:</b> {{ build.Motherboard.name }}</li>
                    <li><b>RAM:</b> {{ build.RAM.name }}</li>
                    <li><b>GPU:</b> {{ build.GPU.name }}</li>
                    <li><b>PSU:</b> {{ build.PSU.name }}</li>
                    <li><b>SSD Storage:</b> {{ build.SSD_Storage.name }}</li>
                    {% if build.HDD_Storage %}
                    <li><b>HDD Storage:</b> {{ build.HDD_Storage.name }}</li>
                    {% endif %}
                    <li><b>Case:</b> {{ build.Case.name }}</li>
                    <li><b>CPU Cooler:</b> {{ build.CPU_Cooler.name }}</li>
                </ul>
            </div>
        {% endfor %}
    {% endif %}

    <!-- Standalone Components Section -->
    {% if cart_items %}
        {% for item in cart_items %}
            <div class="cart-item cart-component">
                <h3 class="cart-component-title">{{ item.content_object.name }}</h3>
                <p class="cart-component-price"><b>Price:</b> ₹{{ item.content_object.price }}</p>
                <form method="post" action="{% url 'remove-from-cart' item.id %}" class="cart-component-remove-form">
                    {% csrf_token %}
                    <button type="submit" class="cart-component-remove-btn">Remove from Cart</button>
                </form>
                <p class="cart-component-description">
                    <b>Description:</b> {{ item.content_object.description }}
                </p>
            </div>
        {% endfor %}
    {% endif %}

    {% if not builds and not cart_items %}
        <p class="cart-empty">Your cart is empty.</p>
    {% endif %}
  </div>

  <!-- Cart Total and Checkout -->
  <div class="cart-summary">
    <div class="cart-total">
      <b>Total:</b> ₹{{ total }}
    </div>
    <a href="{% url 'checkout' %}" class="cart-checkout-btn">Checkout</a>
  </div>
</div>

{% endblock content %}