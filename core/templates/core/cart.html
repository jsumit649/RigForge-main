{% extends 'main.html' %}

{% block content %}

<div class="cart-container">
  <h1 class="cart-title">Your Cart</h1>
  <div class="cart-items">
    <!-- PC Builds Section -->
    {% if builds %}
        {% for build in builds %}
            <div class="cart-item cart-build">
              <div class="cart-card">
                <div class="cart-card-header">
                  <h3 class="cart-build-title">{{ build.Name }}</h3>
                  <div class="cart-build-price">₹{{ build.Total_Price }}</div>
                </div>
                <div class="cart-card-body">
                  <ul class="cart-specs">
                    <li><span>CPU</span><b>{{ build.CPU.name }}</b></li>
                    <li><span>Motherboard</span><b>{{ build.Motherboard.name }}</b></li>
                    <li><span>RAM</span><b>{{ build.RAM.name }}</b></li>
                    {% if build.GPU %}<li><span>GPU</span><b>{{ build.GPU.name }}</b></li>{% endif %}
                    <li><span>PSU</span><b>{{ build.PSU.name }}</b></li>
                    <li><span>SSD</span><b>{{ build.SSD_Storage.name }}</b></li>
                    {% if build.HDD_Storage %}<li><span>HDD</span><b>{{ build.HDD_Storage.name }}</b></li>{% endif %}
                    <li><span>Case</span><b>{{ build.Case.name }}</b></li>
                    <li><span>Cooler</span><b>{{ build.CPU_Cooler.name }}</b></li>
                  </ul>
                </div>
                <div class="cart-card-actions">
                  <form method="post" action="{% url 'remove-build' build.id %}">
                    {% csrf_token %}
                    <button type="submit" class="cart-btn cart-btn-danger btn btn-danger">Remove Build</button>
                  </form>
                </div>
              </div>
            </div>
        {% endfor %}
    {% endif %}

    <!-- Standalone Components Section -->
    {% if cart_items %}
        {% for item in cart_items %}
            <div class="cart-item cart-component">
              <div class="cart-card">
                <div class="cart-card-header">
                  <h3 class="cart-component-title">{{ item.content_object.name }}</h3>
                  <div class="cart-component-price">₹{{ item.content_object.price }}</div>
                </div>
                <div class="cart-card-body">
                  <p class="cart-component-description">{{ item.content_object.description }}</p>
                </div>
                <div class="cart-card-actions">
                  <form method="post" action="{% url 'remove-from-cart' item.id %}">
                    {% csrf_token %}
                    <button type="submit" class="cart-btn cart-btn-danger btn btn-danger">Remove</button>
                  </form>
                </div>
              </div>
            </div>
        {% endfor %}
    {% endif %}

    {% if not builds and not cart_items %}
        <p class="cart-empty">Your cart is empty.</p>
    {% endif %}
  </div>

  <!-- Cart Total and Checkout -->
  <div class="cart-summary">
    <div class="cart-total">
      <b>Total:</b> ₹{{ total }}
    </div>
    <a href="{% url 'checkout' %}" class="cart-checkout-btn">Checkout</a>
  </div>
</div>

{% endblock content %}