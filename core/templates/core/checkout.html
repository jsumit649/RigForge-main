{% extends 'main.html' %}
{% block content %}

<div class="checkout-container">
    <h1 class="checkout-title">Checkout</h1>
    <div class="checkout-breakdown">
        <h3 class="checkout-breakdown-title">Price Breakdown</h3>
        <table class="checkout-breakdown-table">
            <tr>
                <td>Items Total:</td>
                <td>₹{{ items_total }}</td>
            </tr>
            <tr>
                <td>Delivery Fee:</td>
                <td>₹200</td>
            </tr>
            <tr>
                <td>Total Payable:</td>
                <td>₹{{ items_total|add:"200" }}</td>
            </tr>
        </table>
    </div>
    <div class="checkout-address-section">
        <h3 class="checkout-address-title">Select Delivery Address</h3>
        <form method="post" class="checkout-form">
            {% csrf_token %}
            {% if addresses %}
                <div class="checkout-address-list">
                    {% for address in addresses %}
                        <div class="checkout-address-item">
                            <label>
                                <input type="radio" name="address_id" value="{{ address.id }}" {% if forloop.first %}checked{% endif %}>
                                {{ address.line1 }}, {{ address.line2 }}, {{ address.city }}, {{ address.state }}, {{ address.postal_code }}, {{ address.country }}
                            </label>
                        </div>
                    {% endfor %}
                </div>
            {% else %}
                <p class="checkout-no-address">No saved addresses. Please add one below.</p>
            {% endif %}
            <button type="button" class="checkout-add-address-btn" data-toggle="add-address-form">Add New Address</button>
            <div id="add-address-form" class="checkout-add-address-form">
                {{ address_form.as_p }}
                <button type="submit" name="add_address" class="checkout-save-address-btn">Save Address</button>
            </div>
            <hr class="checkout-divider">
            <h3 class="checkout-payment-title">Payment Method</h3>
            <div class="checkout-payment-options">
                <label><input type="radio" name="payment_method" value="cod" checked> Cash on Delivery</label><br>
                <label><input type="radio" name="payment_method" value="upi"> UPI</label><br>
                <label><input type="radio" name="payment_method" value="card"> Card</label>
            </div>
            <button type="submit" name="place_order" class="checkout-place-order-btn">Place Order</button>
        </form>
    </div>
</div>

{% endblock content %}